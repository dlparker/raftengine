.. _test_stepwise_election_1:

========================================================
Test test_stepwise_election_1 from file test_elections_2
========================================================



    This test is mainly for the purpose of testing the test support features implemented
    in the PausingCluster, PausingServer and various related implementations. Other tests already proved
    the basic election process using more granular control methods, this does the same kind of
    thing but using the run_till_trigger model of controlling the code. It is still somewhat
    granular, and serves as a demo of how to build tests that can run things, stop em, examine state, and continue.

    Timers are disabled, so all timer driven operations such as heartbeats are manually triggered.

    

Section 1: Command triggering node three to start election
==========================================================




.. collapse:: section 1 trace table (click to toggle view)

   - See :ref:`Trace Table Legend` for help interpreting table contents

   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | N-1  | N-1                    | N-1   | N-2  | N-2                    | N-2   | N-3  | N-3                         | N-3       |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | Role | Op                     | Delta | Role | Op                     | Delta | Role | Op                          | Delta     |
   +======+========================+=======+======+========================+=======+======+=============================+===========+
   | FLWR |                        |       | FLWR |                        |       | CNDI | NEW ROLE                    |           |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | FLWR |                        |       | FLWR |                        |       | CNDI | poll+N-1 t-1 li-0 lt-1      |           |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | FLWR |                        |       | FLWR |                        |       | CNDI | poll+N-2 t-1 li-0 lt-1      |           |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | FLWR | N-3+poll t-1 li-0 lt-1 | t-1   | FLWR |                        |       | CNDI |                             |           |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | FLWR |                        |       | FLWR | N-3+poll t-1 li-0 lt-1 | t-1   | CNDI |                             |           |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | FLWR | vote+N-3 yes-True      |       | FLWR |                        |       | CNDI |                             |           |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | FLWR |                        |       | FLWR | vote+N-3 yes-True      |       | CNDI |                             |           |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | FLWR |                        |       | FLWR |                        |       | LEAD | N-1+vote yes-True           | lt-1 li-1 |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | FLWR |                        |       | FLWR |                        |       | LEAD | NEW ROLE                    |           |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | FLWR |                        |       | FLWR |                        |       | LEAD | ae+N-1 t-1 i-0 lt-0 e-1 c-0 |           |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | FLWR |                        |       | FLWR |                        |       | LEAD | ae+N-2 t-1 i-0 lt-0 e-1 c-0 |           |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+
   | FLWR |                        |       | FLWR |                        |       | LEAD | N-2+vote yes-True           |           |
   +------+------------------------+-------+------+------------------------+-------+------+-----------------------------+-----------+



.. collapse:: trace sequence diagram (click to toggle view)

   .. plantuml:: /developer/tests/diagrams/test_elections_2/test_stepwise_election_1_1.puml
          :scale: 100%


Section 2: Node 3 has been sent yes vote responses from both other nodes, sending TERM_START log record
=======================================================================================================




.. collapse:: section 2 trace table (click to toggle view)

   - See :ref:`Trace Table Legend` for help interpreting table contents

   +------+-----------------------------+-------+------+-----------------------------+-----------+------+---------------------------+-------+
   | N-1  | N-1                         | N-1   | N-2  | N-2                         | N-2       | N-3  | N-3                       | N-3   |
   +------+-----------------------------+-------+------+-----------------------------+-----------+------+---------------------------+-------+
   | Role | Op                          | Delta | Role | Op                          | Delta     | Role | Op                        | Delta |
   +======+=============================+=======+======+=============================+===========+======+===========================+=======+
   | FLWR | N-3+ae t-1 i-0 lt-0 e-1 c-0 |       | FLWR |                             |           | LEAD |                           |       |
   +------+-----------------------------+-------+------+-----------------------------+-----------+------+---------------------------+-------+
   | FLWR | N-1+ae_reply ok-True mi-1   |       | FLWR |                             |           | LEAD |                           |       |
   +------+-----------------------------+-------+------+-----------------------------+-----------+------+---------------------------+-------+
   | FLWR |                             |       | FLWR | N-3+ae t-1 i-0 lt-0 e-1 c-0 | lt-1 li-1 | LEAD |                           |       |
   +------+-----------------------------+-------+------+-----------------------------+-----------+------+---------------------------+-------+
   | FLWR |                             |       | FLWR | N-2+ae_reply ok-True mi-1   |           | LEAD |                           |       |
   +------+-----------------------------+-------+------+-----------------------------+-----------+------+---------------------------+-------+
   | FLWR |                             |       | FLWR |                             |           | LEAD | N-1+ae_reply ok-True mi-1 | ci-1  |
   +------+-----------------------------+-------+------+-----------------------------+-----------+------+---------------------------+-------+
   | FLWR |                             |       | FLWR |                             |           | LEAD | N-2+ae_reply ok-True mi-1 |       |
   +------+-----------------------------+-------+------+-----------------------------+-----------+------+---------------------------+-------+



.. collapse:: trace sequence diagram (click to toggle view)

   .. plantuml:: /developer/tests/diagrams/test_elections_2/test_stepwise_election_1_2.puml
          :scale: 100%


